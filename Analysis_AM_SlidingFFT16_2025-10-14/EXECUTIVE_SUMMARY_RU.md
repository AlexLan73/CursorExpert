# Резюме (RU)

- Лучший подход: одно батч-ядро «gather → FFT16 → fftshift → запись B» за один проход.
- Не запускать 4 смещённых потока (0,2,4,6): усложняют индексацию, профит минимален для N=16.
- Индексация: для луча L и окна w: s=2·w; x[t]=(s+t<S)?X[L][s+t]:0; FFT16(x)=y; yshift[k]=y[(k+8) mod 16]; B[L][w][k]=yshift[k].
- Для N≤64 фьюзинг быстрее cuFFT и схемы с несколькими ядрами; для N≥512 уместен 2‑шаговый вариант (gather→batched FFT→fftshift).
- Проверки: nW = ceil((S−N)/2)+1; энергия сохраняется; последний блок корректно дополняется нулями.
