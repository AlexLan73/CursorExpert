# üìã –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏: UnifiedFFT —Å –æ–∫–Ω–∞–º–∏ –•–µ–º–º–∏–Ω–≥–∞

## üéØ –û—Å–Ω–æ–≤–Ω–∞—è –∑–∞–¥–∞—á–∞
–°–æ–∑–¥–∞—Ç—å –≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—É—é —Å–∏—Å—Ç–µ–º—É –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ FFT —Å –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ–º –∏ –æ–∫–Ω–∞–º–∏ –•–µ–º–º–∏–Ω–≥–∞, –∫–æ—Ç–æ—Ä–∞—è —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ NVIDIA –∏ AMD GPU —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –≤—ã–±–æ—Ä–æ–º –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –º–µ—Ç–æ–¥–∞.

## üìä –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

### **–°—Ç—Ä–æ–± (StrobeData)**:
```cpp
struct StrobeData {
    int K;                    // –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª—É—á–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, 4)
    int L;                    // –¥–ª–∏–Ω–∞ –ª—É—á–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 1024)
    cuComplex* data;          // K√óL –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã—Ö —á–∏—Å–µ–ª (float)
};
```

### **–û–∫–Ω–∞ –•–µ–º–º–∏–Ω–≥–∞ (HemmingWindows)**:
```cpp
struct HemmingWindows {
    int N;                    // —Ä–∞–∑–º–µ—Ä –æ–∫–Ω–∞ (2^4 –¥–æ 2^15)
    float* windows;           // –æ–∫–Ω–∞ –•–µ–º–º–∏–Ω–≥–∞
    bool is_hemming;          // —Ñ–ª–∞–≥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –æ–∫–Ω–∞
};
```

### **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏**:
```cpp
struct ProcessingConfig {
    int fft_size;             // —Ä–∞–∑–º–µ—Ä FFT (16, 32, 64, 128, 256, 512, 1024, 2048, 4096, 8192, 16384, 32768)
    int step_size;            // —Å–¥–≤–∏–≥ –æ–∫–Ω–∞ (fft_size/8)
    bool use_hemming;         // —Ñ–ª–∞–≥ —É–º–Ω–æ–∂–µ–Ω–∏—è –Ω–∞ –•–µ–º–º–∏–Ω–≥–∞
    bool enable_fftshift;     // —Ñ–ª–∞–≥ fftshift
    ProcessingMode mode;      // AUTO, CUSTOM, LIBRARY
    PerformanceProfile profile; // SPEED, BALANCED, MEMORY
};
```

## üì§ –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

### **–†–µ–∑—É–ª—å—Ç–∞—Ç (OutputData)**:
```cpp
struct OutputData {
    int K;                    // –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª—É—á–µ–π
    int windows_per_ray;      // –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–∫–æ–Ω –Ω–∞ –ª—É—á
    int N;                    // —Ä–∞–∑–º–µ—Ä FFT
    cuComplex* B;             // B[–ª—É—á][–æ–∫–Ω–æ][–≥–∞—Ä–º–æ–Ω–∏–∫–∞]
};
```

### **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤—ã—Ö–æ–¥–Ω–æ–≥–æ –º–∞—Å—Å–∏–≤–∞**:
```
B[ray_index][window_index][harmonic_index]
- ray_index: 0..K-1 (–Ω–æ–º–µ—Ä –ª—É—á–∞)
- window_index: 0..windows_per_ray-1 (–Ω–æ–º–µ—Ä –æ–∫–Ω–∞)
- harmonic_index: 0..N-1 (–Ω–æ–º–µ—Ä –≥–∞—Ä–º–æ–Ω–∏–∫–∏ –ø–æ—Å–ª–µ fftshift)
```

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### **1. –†–∞–∑–º–µ—Ä—ã FFT**:
- **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ**: 16, 32, 64, 128, 256, 512, 1024, 2048, 4096, 8192, 16384, 32768
- **–°–¥–≤–∏–≥**: FFT_size/8 (16‚Üí2, 32‚Üí4, 64‚Üí8, 128‚Üí16, etc.)
- **–ü–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ**: 87.5% (7/8 –æ–∫–Ω–∞)

### **2. –û–∫–Ω–∞ –•–µ–º–º–∏–Ω–≥–∞**:
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∞**: –ø–µ—Ä–≤–∞—è –ø–æ–ª–æ–≤–∏–Ω–∞ - —Ñ—É–Ω–∫—Ü–∏—è –•–µ–º–º–∏–Ω–≥–∞, –≤—Ç–æ—Ä–∞—è –ø–æ–ª–æ–≤–∏–Ω–∞ - –Ω—É–ª–∏
- **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ**: —É–º–Ω–æ–∂–µ–Ω–∏–µ –Ω–∞ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ —Ñ–ª–∞–≥—É is_hemming
- **–†–∞–∑–º–µ—Ä—ã**: —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ä–∞–∑–º–µ—Ä–∞–º FFT

### **3. fftshift**:
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–ø–µ–∫—Ç—Ä–∞–ª—å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –Ω—É–ª–µ–≤–∞—è —á–∞—Å—Ç–æ—Ç–∞ –≤ —Ü–µ–Ω—Ç—Ä–µ, –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ —Å–ø—Ä–∞–≤–∞, –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ —Å–ª–µ–≤–∞
- **–§–æ—Ä–º—É–ª–∞**: yshift[k] = y[(k + N/2) % N]

### **4. GPU –ø–æ–¥–¥–µ—Ä–∂–∫–∞**:
- **NVIDIA**: CUDA + cuFFT
- **AMD**: OpenCL + clFFT
- **CPU**: Fallback —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

## üéØ –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞

### **1. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**:
- **FFT16-256**: >1.0 TFLOP/s (–∫–∞—Å—Ç–æ–º–Ω—ã–µ —è–¥—Ä–∞)
- **FFT512+**: >1.5 TFLOP/s (–±–∏–±–ª–∏–æ—Ç–µ—á–Ω—ã–µ batched FFT)
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**: –ª–∏–Ω–µ–π–Ω–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å —Ä–∞–∑–º–µ—Ä–æ–º batch

### **2. –¢–æ—á–Ω–æ—Å—Ç—å**:
- **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å**: —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å —ç—Ç–∞–ª–æ–Ω–Ω—ã–º –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ–º
- **fftshift**: –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–ø–µ–∫—Ç—Ä–∞–ª—å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
- **–ü–∞–¥–¥–∏–Ω–≥**: –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≥—Ä–∞–Ω–∏—á–Ω—ã—Ö –æ–∫–æ–Ω

### **3. –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å**:
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä**: —Å–∏—Å—Ç–µ–º–∞ —Å–∞–º–∞ –≤—ã–±–∏—Ä–∞–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –º–µ—Ç–æ–¥
- **–ö—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ—Å—Ç—å**: —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ NVIDIA –∏ AMD
- **–ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**: –µ–¥–∏–Ω—ã–π API –¥–ª—è –≤—Å–µ—Ö —Å–ª—É—á–∞–µ–≤

## üìà –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### **–ü—Ä–∏–º–µ—Ä 1: FFT16 —Å –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ–º**:
```cpp
// –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
StrobeData strobe(4, 1024);        // 4 –ª—É—á–∞ √ó 1024 —ç–ª–µ–º–µ–Ω—Ç–∞
HemmingWindows windows(16);        // –æ–∫–Ω–∞ –•–µ–º–º–∏–Ω–≥–∞ –¥–ª—è FFT16
ProcessingConfig config;
config.fft_size = 16;
config.step_size = 2;              // 16/8 = 2
config.use_hemming = true;
config.enable_fftshift = true;
config.mode = AUTO;

// –û–±—Ä–∞–±–æ—Ç–∫–∞
OutputData output;
processSlidingFFT(strobe, windows, config, output);

// –†–µ–∑—É–ª—å—Ç–∞—Ç: B[4][505][16] - 4 –ª—É—á–∞, 505 –æ–∫–æ–Ω, 16 –≥–∞—Ä–º–æ–Ω–∏–∫
```

### **–ü—Ä–∏–º–µ—Ä 2: FFT512 —Å –±–∏–±–ª–∏–æ—Ç–µ—á–Ω—ã–º batched**:
```cpp
// –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
StrobeData strobe(8, 4096);        // 8 –ª—É—á–µ–π √ó 4096 —ç–ª–µ–º–µ–Ω—Ç–æ–≤
HemmingWindows windows(512);       // –æ–∫–Ω–∞ –•–µ–º–º–∏–Ω–≥–∞ –¥–ª—è FFT512
ProcessingConfig config;
config.fft_size = 512;
config.step_size = 64;             // 512/8 = 64
config.use_hemming = true;
config.enable_fftshift = true;
config.mode = LIBRARY;             // –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –±–∏–±–ª–∏–æ—Ç–µ—á–Ω—ã–π

// –û–±—Ä–∞–±–æ—Ç–∫–∞
OutputData output;
processSlidingFFT(strobe, windows, config, output);

// –†–µ–∑—É–ª—å—Ç–∞—Ç: B[8][57][512] - 8 –ª—É—á–µ–π, 57 –æ–∫–æ–Ω, 512 –≥–∞—Ä–º–æ–Ω–∏–∫
```

## üö® –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏

### **1. –ü–∞–º—è—Ç—å**:
- **–ë–æ–ª—å—à–∏–µ FFT**: —Ç—Ä–µ–±—É—é—Ç –º–Ω–æ–≥–æ GPU –ø–∞–º—è—Ç–∏
- **Batched –æ–±—Ä–∞–±–æ—Ç–∫–∞**: —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç memory footprint
- **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∫–æ–ø–∏–∏**: –¥–ª—è –±–∏–±–ª–∏–æ—Ç–µ—á–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤

### **2. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**:
- **–ú–∞–ª—ã–µ FFT**: overhead –±–∏–±–ª–∏–æ—Ç–µ–∫
- **–ë–æ–ª—å—à–∏–µ FFT**: —Å–ª–æ–∂–Ω–æ—Å—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã—Ö —è–¥–µ—Ä
- **Memory bandwidth**: –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–ª—è –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö

### **3. –°–ª–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏**:
- **–ö–∞—Å—Ç–æ–º–Ω—ã–µ —è–¥—Ä–∞**: —Ç—Ä–µ–±—É—é—Ç –≥–ª—É–±–æ–∫–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- **–ë–∏–±–ª–∏–æ—Ç–µ—á–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**: –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–ö—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ—Å—Ç—å**: —Ä–∞–∑–Ω—ã–µ API –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

## üéØ –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–∞ RTX3060**:
- **FFT16**: 2.2 TFLOP/s (–∫–∞—Å—Ç–æ–º–Ω—ã–µ —è–¥—Ä–∞)
- **FFT32**: 1.8 TFLOP/s (–∫–∞—Å—Ç–æ–º–Ω—ã–µ —è–¥—Ä–∞)
- **FFT64**: 1.5 TFLOP/s (–∫–∞—Å—Ç–æ–º–Ω—ã–µ —è–¥—Ä–∞)
- **FFT128**: 1.2 TFLOP/s (–∫–∞—Å—Ç–æ–º–Ω—ã–µ —è–¥—Ä–∞)
- **FFT256**: 1.0 TFLOP/s (–∫–∞—Å—Ç–æ–º–Ω—ã–µ —è–¥—Ä–∞)
- **FFT512**: 1.7 TFLOP/s (cuFFT batched)
- **FFT1024**: 1.8 TFLOP/s (cuFFT batched)
- **FFT2048+**: 1.9+ TFLOP/s (cuFFT batched)

### **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–∞ AMD RX6600**:
- **FFT16**: 1.8 TFLOP/s (–∫–∞—Å—Ç–æ–º–Ω—ã–µ OpenCL —è–¥—Ä–∞)
- **FFT32**: 1.5 TFLOP/s (–∫–∞—Å—Ç–æ–º–Ω—ã–µ OpenCL —è–¥—Ä–∞)
- **FFT64**: 1.2 TFLOP/s (–∫–∞—Å—Ç–æ–º–Ω—ã–µ OpenCL —è–¥—Ä–∞)
- **FFT128**: 1.0 TFLOP/s (–∫–∞—Å—Ç–æ–º–Ω—ã–µ OpenCL —è–¥—Ä–∞)
- **FFT256**: 0.8 TFLOP/s (–∫–∞—Å—Ç–æ–º–Ω—ã–µ OpenCL —è–¥—Ä–∞)
- **FFT512**: 1.5 TFLOP/s (clFFT batched)
- **FFT1024**: 1.6 TFLOP/s (clFFT batched)
- **FFT2048+**: 1.7+ TFLOP/s (clFFT batched)

---

*–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–æ–ª–Ω—É—é —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é –∑–∞–¥–∞—á–∏ –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ UnifiedFFT —Å –æ–∫–Ω–∞–º–∏ –•–µ–º–º–∏–Ω–≥–∞.*