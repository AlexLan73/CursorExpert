# üöÄ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ FFT –≤—ã—á–∏—Å–ª–µ–Ω–∏–π

## üìä –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ FFT32

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã occupancy sweep:
```
windows    ms      GFLOP/s (approx)
1          0.003072 2.08333
2          0.003072 4.16667
4          0.003072 8.33333
8          0.003072 16.6667
16         0.003072 33.3333
32         0.004096 50
64         0.003072 133.333
128        0.004096 200
256        0.004096 400
512        0.00512  640
1024       0.006144 1066.67
2048       0.009216 1422.22
4096       0.01536  1706.67
8192       0.027648 1896.3
16384      0.0512   2048
32768      0.098304 2133.33
65536      0.192512 2178.72
131072     0.379904 2208.09
262144     0.754688 2223.07
524288     1.50528  2229.12
1048576    14.1213  475.231
```

### –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã:

**–ü–∏–∫–æ–≤–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å ~2.23 TFLOP/s –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è –ø—Ä–∏ 262k‚Äì524k –æ–∫–æ–Ω**

- **–ü–∏–∫ –ø—Ä–∏ 262k‚Äì524k –æ–∫–æ–Ω**: –Ω–∞ —ç—Ç–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ SM —É–∂–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–≥—Ä—É–∂–µ–Ω—ã, –∞ –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞ –∑–∞–ø—É—Å–∫/–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –±–ª–æ–∫–æ–≤ —Ö–æ—Ä–æ—à–æ –∞–º–æ—Ä—Ç–∏–∑–∏—Ä—É—é—Ç—Å—è ‚Äî –ø–æ–ª—É—á–∞–µ—Ç—Å—è "–ø–ª–∞—Ç–æ" –ø–æ Throughput.

- **–ü—Ä–æ—Å–∞–¥–∫–∞ –ø–æ—Å–ª–µ 1M –æ–∫–æ–Ω**: –Ω–∞—á–∏–Ω–∞–µ—Ç –¥–æ–º–∏–Ω–∏—Ä–æ–≤–∞—Ç—å overhead –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∏–∑–∞—Ü–∏–∏ –æ—á–µ–Ω—å –±–æ–ª—å—à–æ–≥–æ –≥—Ä–∏–¥-–∞ (–æ—á–µ–Ω—å –º–Ω–æ–≥–æ –±–ª–æ–∫–æ–≤ ‚Üí —Ä–æ—Å—Ç –∑–∞—Ç—Ä–∞—Ç —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞ –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è), –ø–ª—é—Å –≤–æ–∑–º–æ–∂–Ω–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ —á–∞—Å—Ç–æ—Ç—ã –∏–∑-–∑–∞ –¥–ª–∏—Ç–µ–ª—å–Ω–æ–≥–æ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–≥–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è (power/thermal throttling). –ò—Ç–æ–≥ ‚Äî –≤—Ä–µ–º—è —Ä–∞—Å—Ç—ë—Ç –±—ã—Å—Ç—Ä–µ–µ –ª–∏–Ω–µ–π–Ω–æ–≥–æ, GFLOP/s –ø–∞–¥–∞–µ—Ç.

## üéØ –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –ß—Ç–æ –¥–µ–ª–∞—Ç—å –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:

1. **–ó–∞–ø—É—Å–∫–∞—Ç—å –≤ —á–∞–Ω–∫–∞—Ö –ø–æ ~256k‚Äì512k –æ–∫–æ–Ω** –∑–∞ –æ–¥–∏–Ω kernel (batching), –≤–º–µ—Å—Ç–æ –æ–¥–Ω–æ–≥–æ –≥–∏–≥–∞–Ω—Ç—Å–∫–æ–≥–æ –≥—Ä–∏–¥-–∞.

2. **–£–≤–µ–ª–∏—á–∏—Ç—å —Ä–∞–±–æ—Ç—É –Ω–∞ –±–ª–æ–∫**: –±–æ–ª—å—à–µ "–±–∞–±–æ—á–µ–∫" –Ω–∞ –±–ª–æ–∫, –º–µ–Ω—å—à–µ –±–ª–æ–∫–æ–≤ ‚Üí –º–µ–Ω—å—à–µ overhead –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞.

3. **–†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å persistent kernel**: –±–ª–æ–∫–∏ –±–µ—Ä—É—Ç –∑–∞–¥–∞—á–∏ –∏–∑ –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ —Å—á–µ—Ç—á–∏–∫–∞, —á—Ç–æ–±—ã —É–º–µ–Ω—å—à–∏—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å –æ–≥—Ä–æ–º–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –±–ª–æ–∫–æ–≤.

4. **–í –±–æ–µ–≤–æ–º –∫–æ–¥–µ –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—Ç—å H2D/D2H streams**: —É –Ω–∞—Å –≤ –∑–∞–º–µ—Ä–µ –∫–æ–ø–∏–π –Ω–µ—Ç, –Ω–æ –≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ.

## üìã –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞–¥–∞—á–µ

### –°—Ü–µ–Ω–∞—Ä–∏–π: 4 –ø–æ—Ç–æ–∫–∞ –ø–æ FFT32, –≤ –∫–∞–∂–¥–æ–º –ø–æ—Ç–æ–∫–µ 2048 –æ–∫–æ–Ω

**–ö–∞–∫ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∫ –≤–∞—à–µ–π –∑–∞–¥–∞—á–µ:**

- **–ß—Ç–æ –ø–æ–∫–∞–∑–∞–ª sweep**: –≤—ã—Å–æ–∫–∞—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å ~8k –æ–∫–æ–Ω —Å—É–º–º–∞—Ä–Ω–æ –Ω–∞ –¥–µ–≤–∞–π—Å–µ –∏ –ø–ª–∞—Ç–æ –æ–∫–æ–ª–æ 262k‚Äì524k. –ü—Ä–∏ 2048 –æ–∫–æ–Ω –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–∏–∂–µ –∏–∑‚Äë–∑–∞ –æ–≤–µ—Ä—Ö–µ–¥–∞.

### –í–∞—Ä–∏–∞–Ω—Ç—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:

#### –í–∞—Ä–∏–∞–Ω—Ç A: –ù–∏–∑–∫–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞
- **–ó–∞–ø—É—Å–∫–∞–π—Ç–µ –≤—Å–µ 4 –ø–æ—Ç–æ–∫–∞ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ**, –ø–æ 2048 –æ–∫–æ–Ω –≤ –∫–∞–∂–¥–æ–º
- **–°—É–º–º–∞—Ä–Ω–æ —ç—Ç–æ 8192 –æ–∫–Ω–∞** ‚Üí –≤—ã —É–∂–µ –ø–æ–ø–∞–¥–∞–µ—Ç–µ –≤ ¬´—Ö–æ—Ä–æ—à—É—é¬ª –∑–æ–Ω—É –∏ –±–ª–∏–∑–∫–æ –∫ –ø–∏–∫—É –¥–ª—è –º–∞–ª—ã—Ö –ø–∞—Ä—Ç–∏–π
- **–ù–∞—Å—Ç—Ä–æ–π–∫–∏**: 4 CUDA streams, –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∑–∞–ø—É—Å–∫–∏

#### –í–∞—Ä–∏–∞–Ω—Ç B: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å  
- **–í –∫–∞–∂–¥–æ–º –ø–æ—Ç–æ–∫–µ –≤–º–µ—Å—Ç–æ 2048 –∑–∞–ø—É—Å–∫–∞–π—Ç–µ –±–∞—Ç—á –ø–æ 8192** (—Å–∫–ª–µ–∏—Ç—å 4√ó2048) –æ–¥–Ω–∏–º —è–¥—Ä–æ–º
- **–ú–µ–Ω—å—à–µ –∑–∞–ø—É—Å–∫–æ–≤** ‚Üí –≤—ã—à–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
- **–õ–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –≤—ã—Ä–∞—Å—Ç–µ—Ç** –Ω–∞ –≤—Ä–µ–º—è –±—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏–∏ 4 –ø–∞—Ä—Ç–∏–π

#### –í–∞—Ä–∏–∞–Ω—Ç C: –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –ø–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö
- **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ "ring buffer"** –∏ –∫–æ–ø–∏—Ç–µ –¥–æ 16k‚Äì32k –æ–∫–æ–Ω —Å—É–º–º–∞—Ä–Ω–æ (–ø–æ –≤—Å–µ–º –ø–æ—Ç–æ–∫–∞–º) –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º
- **–≠—Ç–æ –µ—â—ë —Å–∏–ª—å–Ω–µ–µ —Ä–∞–∑–≥—Ä—É–∑–∏—Ç —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞**

### –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

#### –ü–ª–∞–Ω –ø–æ —è–¥—Ä–∞–º:
- **–î–ª—è –±–∞—Ç—á–µ–≤–æ–≥–æ —è–¥—Ä–∞ FFT32 —Å 32 ¬´–±–∞–±–æ—á–∫–∞–º–∏¬ª/–±–ª–æ–∫**: `blockDim=(32,32)`, `gridDim=ceil(num_windows/32)`
- **–î–ª—è 2048 –æ–∫–æ–Ω**: `gridDim=64`
- **–î–ª—è 8192**: `gridDim=256`

#### –û—á–µ—Ä–µ–¥–∏/–ø–æ—Ç–æ–∫–∏:
1. **–°–æ–∑–¥–∞–π—Ç–µ 4 CUDA streams**
2. **–ü–æ–¥–∞–≤–∞–π—Ç–µ H2D –∫–æ–ø–∏–∏ –∏ –∑–∞–ø—É—Å–∫–∏ —è–¥–µ—Ä** –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π stream
3. **–ü–µ—Ä–µ–∫—Ä—ã–≤–∞–π—Ç–µ H2D/D2H –∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è**
4. **–ï—Å–ª–∏ –µ—Å—Ç—å –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –ø–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö** ‚Äî —Ñ–∏–∫—Å–∏—Ä—É–π—Ç–µ —á–∞–Ω–∫–∏ –∏ –ø—É—Å–∫–∞–π—Ç–µ ¬´–ø–∞—Ä–æ–≤–æ–∑–æ–º¬ª: `H2D(next) || kernel(curr) || D2H(prev)`

### –ö–æ–≥–¥–∞ –¥–µ–ª–∏—Ç—å –Ω–∞ —á–∞–Ω–∫–∏:

- **–ù–µ –¥–µ–ª–∞–π—Ç–µ –æ–¥–∏–Ω –≥–∏–≥–∞–Ω—Ç—Å–∫–∏–π –∑–∞–ø—É—Å–∫ >1M –æ–∫–æ–Ω** ‚Äî –≤–∏–¥–Ω–æ –ø—Ä–æ—Å–∞–¥–∫—É (—Ñ—Ä–æ–Ω—Ç–µ–Ω–¥/–¥–∏—Å–ø–µ—Ç—á–µ—Ä–∏–∑–∞—Ü–∏—è)
- **–î–µ—Ä–∂–∏—Ç–µ ¬´—Ä–∞–∑–º–µ—Ä —á–∞–Ω–∫–∞¬ª –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ 8k‚Äì64k –æ–∫–æ–Ω** —Å—É–º–º–∞—Ä–Ω–æ –Ω–∞ –¥–µ–≤–∞–π—Å –∑–∞ –≤–æ–ª–Ω—É –∑–∞–ø—É—Å–∫–æ–≤ (–Ω–∞–±–æ—Ä –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö —Å—Ç—Ä–∏–º–æ–≤)
- **–≠—Ç–æ –¥–∞—ë—Ç –≤—ã—Å–æ–∫–∏–π Throughput** –±–µ–∑ –ø–µ—Ä–µ–≥—Ä—É–∑–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞

### –ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –µ—â—ë –≤—ã—à–µ –∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ –º–∞–ª—ã—Ö –ø–∞—Ä—Ç–∏—è—Ö (2048) –∏ –º–∞–ª–æ –ø–æ—Ç–æ–∫–æ–≤:

- **–£–≤–µ–ª–∏—á—å—Ç–µ ¬´—Ä–∞–±–æ—Ç—ã –Ω–∞ –±–ª–æ–∫¬ª** (–±–æ–ª—å—à–µ –æ–∫–æ–Ω –Ω–∞ –±–ª–æ–∫) –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ persistent kernel (–±–ª–æ–∫–∏ –≤—ã—Ç—è–≥–∏–≤–∞—é—Ç –∑–∞–¥–∞—á–∏ –∏–∑ –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ —Å—á—ë—Ç—á–∏–∫–∞)
- **–≠—Ç–æ —Å–æ–∫—Ä–∞—â–∞–µ—Ç —á–∏—Å–ª–æ –±–ª–æ–∫–æ–≤** –∏ –æ–≤–µ—Ä—Ö–µ–¥ –∑–∞–ø—É—Å–∫–æ–≤

## üéØ –ò—Ç–æ–≥–æ–≤—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è 4√ó2048 –æ–∫–æ–Ω:

### –í–∞—Ä–∏–∞–Ω—Ç A (–Ω–∏–∑–∫–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞):
- **4 —Å—Ç—Ä–∏–º–∞ √ó 2048 –æ–∫–æ–Ω** ‚Üí –∑–∞–ø—É—Å–∫–∞—Ç—å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- **–í—ã –±–ª–∏–∑–∫–æ –∫ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π –∑–æ–Ω–µ**

### –í–∞—Ä–∏–∞–Ω—Ç B (–ª—É—á—à–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å):
- **–í –∫–∞–∂–¥–æ–º —Å—Ç—Ä–∏–º–µ —Å–∫–ª–µ–∏–≤–∞—Ç—å 4 –ø–∞—Ä—Ç–∏–∏** –∏ –∑–∞–ø—É—Å–∫–∞—Ç—å 8192 –æ–∫–æ–Ω –æ–¥–Ω–∏–º —è–¥—Ä–æ–º
- **–ú–µ–Ω—å—à–µ –∑–∞–ø—É—Å–∫–æ–≤, –≤—ã—à–µ GFLOP/s**, –Ω–æ –±–æ–ª—å—à–µ –∑–∞–¥–µ—Ä–∂–∫–∞ –Ω–∞ —Å–±–æ—Ä

---

*–î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ occupancy sweep FFT32 –∏ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏*